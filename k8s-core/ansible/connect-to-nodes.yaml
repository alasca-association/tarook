---
- name: Initialize node connection
  hosts: "{{ target_hosts | default('all:!orchestrator') }}"
  gather_facts: false
  vars_files:
  - vars/disruption.yaml
  - vars/auto_generated_preamble.yaml
  - vars/etc.yaml
  - vars/retries.yaml
  - vars/vault-config.yaml
  roles:
  - role: bootstrap/detect-user
    tags:
    - detect-user
    - bootstrap/detect-user
    - always
  - role: bootstrap/prepare-node
    tags:
    - prepare-node
    - bootstrap/prepare-node
    - always
  - role: helpers/vault-onboarded
    tags:
    - vault-onboarded
    - helpers/vault-onboarded
    - always
  - role: bootstrap/ssh-known-hosts
    tags:
    - ssh-known-hosts
    - bootstrap/ssh-known-hosts
    - always
...
