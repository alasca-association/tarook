---
- name: Create passwordstore directory
  become: false
  delegate_to: localhost
  run_once: true
  file:
    path: "{{ etc_dir }}/passwordstore"
    state: directory
    mode: 0755

- name: Initialize passwordstore  # noqa jinja[spacing]
  become: false
  delegate_to: localhost
  run_once: true
  # Technically `pass init` might change something but this change isn't relevant for us.
  changed_when: false
  command:
  args:
    argv: >
      {%- set pass_cmd = ["pass", "init"] %}
      {%- for u in passwordstore_users %}
        {%- set _ = pass_cmd.append(u.gpg_id) %}
      {%- endfor %}
      {{- pass_cmd -}}
  environment:
    PASSWORD_STORE_DIR: "{{ etc_dir }}/passwordstore"
...
