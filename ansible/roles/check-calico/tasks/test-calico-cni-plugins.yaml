---
- name: Define Environment
  environment:
    KUBECONFIG: /etc/kubernetes/admin.conf
    DATASTORE_TYPE: kubernetes

  block:
  - name: Check /opt/cni/bin/calico
    become: true
    stat:
      path: /opt/cni/bin/calico
    register: cni_stat_result
    failed_when: "( cni_stat_result.stat.exists != true ) and ( cni_stat_result.stat.executable != true )"

  - name: Check /opt/cni/bin/calico-ipam
    become: true
    stat:
      path: /opt/cni/bin/calico-ipam
    register: ipam_stat_result
    failed_when: "( ipam_stat_result.stat.exists != true ) and ( ipam_stat_result.stat.executable != true )"
