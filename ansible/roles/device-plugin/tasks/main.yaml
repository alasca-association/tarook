# kubectl apply -f https://raw.githubusercontent.com/NVIDIA/k8s-device-plugin/1.0.0-beta4/nvidia-device-plugin.yml

- name: Install k8s nvidia-device-plugin
  become: no
  environment:
    KUBECONFIG: /etc/kubernetes/admin.conf
  k8s:
    state: present
    apply: yes
    definition: "{{ lookup('template', 'nvidia-device-plugin.yml') }}"
    validate:
      fail_on_error: yes
      strict: yes
  when: is_gpu_cluster
