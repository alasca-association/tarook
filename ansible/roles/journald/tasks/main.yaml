- name: Check if the node has kubernetes installed
  stat:
    path: "/etc/kubernetes"
  register: kubernetes_dir

- block:

  - name: Create configuration for journald
    become: yes
    template:
      src: journald.conf.j2
      dest: /etc/systemd/journald.conf

  - name: Restart journald
    become: yes
    systemd:
      enabled: yes
      state: restarted
      daemon_reload: yes
      name: systemd-journald

  when: "_allow_disruption or not kubernetes_dir.stat.exists"
