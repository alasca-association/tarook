- name: Prepare Kubernetes Nodes
  include_tasks: prepare_nodes.yaml

- name: Setup IPPools
  include_tasks: setup_ippools.yaml

- name: Setup Calico Typha
  include_tasks: setup_typha.yaml

- name: Setup Calico/Node
  include_tasks: setup_calico_node.yaml

- name: Remove key-material of calico/node and Typha as well as Typha CA from initial master node
  become: yes
  file:
    state: absent
    path: "/etc/kubernetes/pki/typha/"

- name: Setup BGP Routing Information Distribution via BIRD
  include_tasks: setup_bgp.yaml
