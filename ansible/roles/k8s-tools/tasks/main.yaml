---
- name: Ensure that pip is installed
  become: yes
  package:
    state: present
    name:
    - python3-pip
  tags:
  - k8s-tools

- name: Ensure that kubernetes libraries is installed
  become: yes
  pip:
    name:
    - openshift
      # Workaround: pin the version here because 12.0.0 introduces a breaking change.
      # even if specified otherwise in the kubeconfig, the module will try to contact localhost:80
    - kubernetes==11.0.0
    - kubernetes-validate
    state: present
    extra_args: "{{ (ansible_pkg_mgr == 'apt') | ternary('--system', '') }}"
  tags:
  - k8s-tools
