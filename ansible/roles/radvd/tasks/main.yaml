- name: Install radvd package (apt)
  become: yes
  apt:
    name: radvd
    state: present
  when: ansible_pkg_mgr == 'apt'
  tags:
  - radvd

- name: Install radvd package (yum)
  become: yes
  yum:
    name: radvd
    state: present
  when: ansible_pkg_mgr == 'yum'
  tags:
  - radvd

- name: Install radvd package (dnf)
  become: yes
  dnf:
    name: radvd
    state: present
  when: ansible_pkg_mgr == 'dnf'
  tags:
  - radvd

- name: Enable net.ipv6.conf.all.forwarding
  become: yes
  sysctl:
    name: net.ipv6.conf.all.forwarding
    value: "1"
    state: present
  tags:
  - radvd

- name: Create radvd configuration
  become: yes
  template:
    src: radvd.conf
    dest: /etc/
    owner: root
    group: root
    mode: 0640
  notify: restart radvd
  tags:
  - radvd

- name: enable radvd
  become: yes
  systemd:
    name: radvd
    enabled: yes
  tags:
  - radvd
