- name: Install nvidia-docker2
  block:
  - name: Get distribution
    shell: ". /etc/os-release;echo $ID$VERSION_ID"
    register: distribution

  - name: Install nvidia-docker2 repo
    get_url:
      url: "https://nvidia.github.io/nvidia-docker/{{ distribution.stdout }}/nvidia-docker.repo"
      dest: /etc/yum.repos.d/nvidia-docker.repo

  - name: Install nvidia-docker2 packages
    package:
      name: "{{ packages }}"
    vars:
      packages:
      - nvidia-docker2
